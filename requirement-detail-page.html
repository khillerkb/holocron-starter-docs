<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REQ-SEC-001 | Technical Requirements System</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Work+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* AWS-inspired color palette */
            --aws-dark: #232f3e;
            --aws-orange: #ff9900;
            --aws-blue: #146eb4;
            --aws-squid: #527fff;
            
            /* Well-Architected Pillar Colors */
            --pillar-ops: #00a1c9;
            --pillar-security: #d13212;
            --pillar-reliability: #1d8102;
            --pillar-performance: #7d3c98;
            --pillar-cost: #ff9900;
            --pillar-sustainability: #16a34a;
            
            /* Neutrals */
            --gray-50: #fafafa;
            --gray-100: #f4f4f5;
            --gray-200: #e4e4e7;
            --gray-300: #d4d4d8;
            --gray-400: #a1a1aa;
            --gray-500: #71717a;
            --gray-600: #52525b;
            --gray-700: #3f3f46;
            --gray-800: #27272a;
            --gray-900: #18181b;
            
            /* Status colors */
            --status-draft: #fbbf24;
            --status-review: #3b82f6;
            --status-approved: #10b981;
            --status-deprecated: #ef4444;
            
            /* RFC levels */
            --rfc-must: #dc2626;
            --rfc-should: #f59e0b;
            --rfc-may: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Work Sans', -apple-system, sans-serif;
            background: var(--gray-50);
            color: var(--gray-900);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .header-content {
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .breadcrumb a {
            color: var(--aws-blue);
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: var(--aws-orange);
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        .btn-primary {
            background: var(--aws-orange);
            color: white;
        }

        .btn-primary:hover {
            background: #ec7211;
        }

        /* Main Layout */
        .container {
            max-width: 1800px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Requirement Header Card */
        .req-header {
            background: white;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .req-header-top {
            background: linear-gradient(135deg, var(--aws-dark) 0%, #37475a 100%);
            padding: 2rem;
            color: white;
        }

        .req-id {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--aws-orange);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .req-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .req-summary {
            font-size: 1.125rem;
            line-height: 1.6;
            opacity: 0.95;
        }

        .req-header-meta {
            padding: 1.5rem 2rem;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .meta-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gray-500);
            font-weight: 600;
        }

        .meta-value {
            font-size: 0.875rem;
            color: var(--gray-900);
            font-weight: 600;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-approved {
            background: rgba(16, 185, 129, 0.1);
            color: var(--status-approved);
        }

        .rfc-badge {
            display: inline-flex;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .rfc-must {
            background: rgba(220, 38, 38, 0.1);
            color: var(--rfc-must);
        }

        /* Tabs */
        .tabs {
            background: white;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .tab-list {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab.active {
            background: white;
            color: var(--aws-blue);
            border-bottom-color: var(--aws-blue);
        }

        .tab:hover:not(.active) {
            background: white;
            color: var(--gray-900);
        }

        .tab-content {
            padding: 2rem;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Metamodel Grid */
        .metamodel-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .field-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .field-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .required-indicator {
            color: var(--rfc-must);
            font-size: 1rem;
        }

        .field-value {
            padding: 0.75rem;
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 6px;
            font-size: 0.875rem;
            color: var(--gray-900);
        }

        .field-value code {
            font-family: 'JetBrains Mono', monospace;
            background: white;
            padding: 0.125rem 0.375rem;
            border-radius: 3px;
            font-size: 0.8125rem;
        }

        /* AWS Pillar Tags */
        .pillar-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .pillar-tag {
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 2px solid;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .pillar-ops {
            background: rgba(0, 161, 201, 0.1);
            border-color: var(--pillar-ops);
            color: var(--pillar-ops);
        }

        .pillar-security {
            background: rgba(209, 50, 18, 0.1);
            border-color: var(--pillar-security);
            color: var(--pillar-security);
        }

        .pillar-reliability {
            background: rgba(29, 129, 2, 0.1);
            border-color: var(--pillar-reliability);
            color: var(--pillar-reliability);
        }

        .pillar-performance {
            background: rgba(125, 60, 152, 0.1);
            border-color: var(--pillar-performance);
            color: var(--pillar-performance);
        }

        .pillar-cost {
            background: rgba(255, 153, 0, 0.1);
            border-color: var(--pillar-cost);
            color: var(--pillar-cost);
        }

        .pillar-sustainability {
            background: rgba(22, 163, 74, 0.1);
            border-color: var(--pillar-sustainability);
            color: var(--pillar-sustainability);
        }

        /* Code Block */
        .code-block {
            background: var(--gray-900);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            position: relative;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .code-language {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--aws-orange);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .code-copy {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 0.375rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .code-copy:hover {
            background: rgba(255,255,255,0.2);
        }

        pre {
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8125rem;
            line-height: 1.6;
            color: #e5e7eb;
        }

        .code-keyword { color: #f472b6; }
        .code-string { color: #a78bfa; }
        .code-comment { color: #6b7280; font-style: italic; }
        .code-function { color: #60a5fa; }
        .code-variable { color: #fbbf24; }

        /* Markdown Content */
        .markdown-content {
            line-height: 1.8;
        }

        .markdown-content h1,
        .markdown-content h2,
        .markdown-content h3 {
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-weight: 700;
        }

        .markdown-content h1 {
            font-size: 1.75rem;
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 0.5rem;
        }

        .markdown-content h2 {
            font-size: 1.5rem;
        }

        .markdown-content h3 {
            font-size: 1.25rem;
        }

        .markdown-content ul,
        .markdown-content ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .markdown-content li {
            margin-bottom: 0.5rem;
        }

        .markdown-content code {
            background: var(--gray-100);
            padding: 0.125rem 0.375rem;
            border-radius: 3px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }

        .markdown-content blockquote {
            border-left: 4px solid var(--aws-orange);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--gray-600);
            font-style: italic;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-card {
            background: white;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            padding: 1.5rem;
        }

        .sidebar-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--gray-900);
        }

        .info-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gray-500);
            font-weight: 600;
        }

        .info-value {
            font-size: 0.875rem;
            color: var(--gray-900);
        }

        .link-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .link-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--gray-50);
            border-radius: 6px;
            text-decoration: none;
            color: var(--aws-blue);
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .link-item:hover {
            background: var(--gray-100);
            transform: translateX(4px);
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            padding: 0.25rem 0.75rem;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: 16px;
            font-size: 0.75rem;
            color: var(--gray-700);
            font-weight: 500;
        }

        /* Validation Rules */
        .validation-rules {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .validation-rule {
            padding: 0.75rem;
            background: var(--gray-50);
            border-left: 3px solid var(--status-approved);
            border-radius: 4px;
            font-size: 0.875rem;
        }

        .validation-rule.warning {
            border-left-color: var(--status-draft);
        }

        .validation-rule.error {
            border-left-color: var(--status-deprecated);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                grid-column: 1;
            }
            
            .metamodel-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .main-content > * {
            animation: fadeInUp 0.5s ease-out;
        }

        .main-content > *:nth-child(1) { animation-delay: 0.1s; }
        .main-content > *:nth-child(2) { animation-delay: 0.2s; }
        .main-content > *:nth-child(3) { animation-delay: 0.3s; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="breadcrumb">
                <a href="#">Home</a>
                <span>/</span>
                <a href="#">Requirements</a>
                <span>/</span>
                <a href="#">Security</a>
                <span>/</span>
                <span>REQ-SEC-001</span>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary">Export</button>
                <button class="btn btn-secondary">Version History</button>
                <button class="btn btn-primary">Edit Requirement</button>
            </div>
        </div>
    </header>

    <div class="container">
        <main class="main-content">
            <!-- Requirement Header -->
            <div class="req-header">
                <div class="req-header-top">
                    <div class="req-id">REQ-SEC-001</div>
                    <h1 class="req-title">Multi-Factor Authentication Implementation</h1>
                    <p class="req-summary">The system MUST implement multi-factor authentication (MFA) for all user access points, requiring at least two independent factors for authentication verification.</p>
                </div>
                <div class="req-header-meta">
                    <div class="meta-item">
                        <div class="meta-label">Status</div>
                        <div class="meta-value">
                            <span class="status-badge status-approved">
                                <span>‚óè</span>
                                Approved
                            </span>
                        </div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">RFC Level</div>
                        <div class="meta-value">
                            <span class="rfc-badge rfc-must">MUST</span>
                        </div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Priority</div>
                        <div class="meta-value">P0 - Critical</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Version</div>
                        <div class="meta-value">2.1.0</div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab-list">
                    <button class="tab active" data-tab="metamodel">Metamodel</button>
                    <button class="tab" data-tab="opa">OPA Policy</button>
                    <button class="tab" data-tab="agents">Agents & Workflow</button>
                    <button class="tab" data-tab="validation">Validation</button>
                </div>

                <!-- Metamodel Tab -->
                <div class="tab-content">
                    <div class="tab-panel active" id="metamodel">
                        <h2 style="margin-bottom: 1.5rem; font-size: 1.25rem; font-weight: 700;">Requirement Attributes</h2>
                        
                        <div class="metamodel-grid">
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="required-indicator">*</span>
                                    Requirement ID
                                </label>
                                <div class="field-value"><code>REQ-SEC-001</code></div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    <span class="required-indicator">*</span>
                                    Requirement Type
                                </label>
                                <div class="field-value">Functional Security Requirement</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    <span class="required-indicator">*</span>
                                    Category
                                </label>
                                <div class="field-value">Security / Identity & Access Management</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    RFC 2119 Level
                                </label>
                                <div class="field-value"><code>MUST</code> (Absolute requirement)</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Source Standard
                                </label>
                                <div class="field-value">IEEE/ISO/IEC 29148-2018, NIST 800-63B</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Compliance Framework
                                </label>
                                <div class="field-value">SOC 2, ISO 27001, PCI DSS 3.2.1</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Owner
                                </label>
                                <div class="field-value">Security Architecture Team</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Stakeholders
                                </label>
                                <div class="field-value">CISO, IAM Team, DevSecOps, Compliance</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Created Date
                                </label>
                                <div class="field-value">2024-01-15</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Last Modified
                                </label>
                                <div class="field-value">2024-11-22</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Rationale
                                </label>
                                <div class="field-value">Prevents unauthorized access through compromised credentials; aligns with zero-trust architecture principles and regulatory requirements.</div>
                            </div>

                            <div class="field-group">
                                <label class="field-label">
                                    Acceptance Criteria
                                </label>
                                <div class="field-value">
                                    <ul style="margin: 0; padding-left: 1.25rem;">
                                        <li>MFA enforced for 100% of user accounts</li>
                                        <li>Minimum 2 authentication factors required</li>
                                        <li>Support for TOTP, WebAuthn, SMS</li>
                                        <li>Grace period: 24 hours for new users</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-size: 1.125rem; font-weight: 700;">AWS Well-Architected Pillars</h3>
                        <div class="pillar-tags">
                            <div class="pillar-tag pillar-security">
                                <span>üõ°Ô∏è</span>
                                Security
                            </div>
                            <div class="pillar-tag pillar-ops">
                                <span>‚öôÔ∏è</span>
                                Operational Excellence
                            </div>
                            <div class="pillar-tag pillar-reliability">
                                <span>üîÑ</span>
                                Reliability
                            </div>
                        </div>

                        <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-size: 1.125rem; font-weight: 700;">Well-Architected Best Practices</h3>
                        <div class="validation-rules">
                            <div class="validation-rule">
                                <strong>SEC03-BP02:</strong> Implement strong identity foundation with MFA
                            </div>
                            <div class="validation-rule">
                                <strong>SEC02-BP03:</strong> Grant least privilege access with MFA enforcement
                            </div>
                            <div class="validation-rule">
                                <strong>OPS05-BP01:</strong> Use multi-factor authentication for operational access
                            </div>
                        </div>
                    </div>

                    <!-- OPA Policy Tab -->
                    <div class="tab-panel" id="opa">
                        <h2 style="margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">OPA Rego Validation Policy</h2>
                        <p style="margin-bottom: 1.5rem; color: var(--gray-600);">
                            This Open Policy Agent (OPA) policy validates runtime compliance with the MFA requirement across all authentication endpoints.
                        </p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">Rego Policy</span>
                                <button class="code-copy">Copy</button>
                            </div>
                            <pre><span class="code-keyword">package</span> <span class="code-variable">techreq.security.mfa</span>

<span class="code-comment"># REQ-SEC-001: Multi-Factor Authentication Validation Policy</span>
<span class="code-comment"># This policy enforces MFA requirements at runtime</span>

<span class="code-keyword">import</span> future.keywords.if
<span class="code-keyword">import</span> future.keywords.in

<span class="code-comment"># Default deny - fail closed</span>
<span class="code-keyword">default</span> allow = <span class="code-keyword">false</span>

<span class="code-comment"># MUST: All authentication requests require MFA</span>
allow if {
    <span class="code-function">is_authenticated</span>
    <span class="code-function">has_valid_mfa</span>
    <span class="code-function">mfa_factors_sufficient</span>
    <span class="code-keyword">not</span> <span class="code-function">is_exempted_account</span>
}

<span class="code-comment"># Check if user has completed MFA</span>
has_valid_mfa if {
    input.auth.mfa_verified == <span class="code-keyword">true</span>
    input.auth.mfa_timestamp
    <span class="code-function">time_since_mfa_seconds</span> < <span class="code-variable">300</span> <span class="code-comment"># 5 minute validity</span>
}

<span class="code-comment"># Validate minimum two factors</span>
mfa_factors_sufficient if {
    <span class="code-function">count</span>(input.auth.factors) >= <span class="code-variable">2</span>
    <span class="code-function">valid_factor_combination</span>
}

<span class="code-comment"># Valid factor combinations</span>
valid_factor_combination if {
    factors := input.auth.factors
    <span class="code-string">"password"</span> in factors
    {<span class="code-string">"totp"</span>, <span class="code-string">"webauthn"</span>, <span class="code-string">"sms"</span>} & factors
}

<span class="code-comment"># Check for temporary exemptions (new users &lt; 24h)</span>
is_exempted_account if {
    input.user.created_at
    <span class="code-function">time_since_creation_hours</span> < <span class="code-variable">24</span>
    input.user.exemption_reason == <span class="code-string">"new_user_grace_period"</span>
}

<span class="code-comment"># Calculate time since MFA verification</span>
time_since_mfa_seconds = seconds if {
    mfa_time := <span class="code-function">time.parse_rfc3339_ns</span>(input.auth.mfa_timestamp)
    current_time := <span class="code-function">time.now_ns</span>()
    seconds := (current_time - mfa_time) / <span class="code-variable">1000000000</span>
}

<span class="code-comment"># Calculate time since account creation</span>
time_since_creation_hours = hours if {
    created_time := <span class="code-function">time.parse_rfc3339_ns</span>(input.user.created_at)
    current_time := <span class="code-function">time.now_ns</span>()
    hours := (current_time - created_time) / <span class="code-variable">3600000000000</span>
}

<span class="code-comment"># Violation messages for debugging</span>
violations[msg] {
    <span class="code-keyword">not</span> has_valid_mfa
    msg := <span class="code-string">"MFA verification required but not present or expired"</span>
}

violations[msg] {
    <span class="code-keyword">not</span> mfa_factors_sufficient
    msg := <span class="code-function">sprintf</span>(<span class="code-string">"Insufficient authentication factors: %v (minimum 2 required)"</span>, 
        [<span class="code-function">count</span>(input.auth.factors)])
}

<span class="code-comment"># Audit log generation</span>
audit_log = log if {
    log := {
        <span class="code-string">"requirement_id"</span>: <span class="code-string">"REQ-SEC-001"</span>,
        <span class="code-string">"policy_decision"</span>: allow,
        <span class="code-string">"user_id"</span>: input.user.id,
        <span class="code-string">"timestamp"</span>: <span class="code-function">time.now_ns</span>(),
        <span class="code-string">"factors_used"</span>: input.auth.factors,
        <span class="code-string">"violations"</span>: violations
    }
}</pre>
                        </div>

                        <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-size: 1.125rem; font-weight: 700;">Test Cases</h3>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">Rego Test</span>
                                <button class="code-copy">Copy</button>
                            </div>
                            <pre><span class="code-keyword">package</span> <span class="code-variable">techreq.security.mfa_test</span>

<span class="code-keyword">import</span> data.techreq.security.mfa

<span class="code-comment"># Test: Valid MFA with password + TOTP</span>
test_valid_mfa_allowed {
    mfa.allow with input as {
        <span class="code-string">"user"</span>: {<span class="code-string">"id"</span>: <span class="code-string">"user123"</span>, <span class="code-string">"created_at"</span>: <span class="code-string">"2024-01-01T00:00:00Z"</span>},
        <span class="code-string">"auth"</span>: {
            <span class="code-string">"mfa_verified"</span>: <span class="code-keyword">true</span>,
            <span class="code-string">"mfa_timestamp"</span>: <span class="code-function">time.now_ns</span>(),
            <span class="code-string">"factors"</span>: [<span class="code-string">"password"</span>, <span class="code-string">"totp"</span>]
        }
    }
}

<span class="code-comment"># Test: Missing MFA denied</span>
test_missing_mfa_denied {
    <span class="code-keyword">not</span> mfa.allow with input as {
        <span class="code-string">"user"</span>: {<span class="code-string">"id"</span>: <span class="code-string">"user123"</span>},
        <span class="code-string">"auth"</span>: {
            <span class="code-string">"mfa_verified"</span>: <span class="code-keyword">false</span>,
            <span class="code-string">"factors"</span>: [<span class="code-string">"password"</span>]
        }
    }
}</pre>
                        </div>
                    </div>

                    <!-- Agents & Workflow Tab -->
                    <div class="tab-panel" id="agents">
                        <h2 style="margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">Agents & Workflow Configuration</h2>
                        <p style="margin-bottom: 1.5rem; color: var(--gray-600);">
                            This document defines the AI agents, automation workflows, and guardrails required to implement and maintain this requirement.
                        </p>

                        <div class="code-block" style="background: white; border: 1px solid var(--gray-200);">
                            <div class="code-header" style="border-bottom-color: var(--gray-200);">
                                <span class="code-language" style="color: var(--aws-blue);">agents.md</span>
                                <button class="code-copy">Copy</button>
                            </div>
                            <div class="markdown-content">
                                <h1>REQ-SEC-001: MFA Implementation Agents & Workflow</h1>

                                <h2>Overview</h2>
                                <p>This document defines the automated agents, workflows, and guardrails for implementing and maintaining multi-factor authentication across all system access points.</p>

                                <h2>Agent Configuration</h2>

                                <h3>1. Compliance Validation Agent</h3>
                                <ul>
                                    <li><strong>Purpose:</strong> Continuously monitor MFA enforcement across all authentication endpoints</li>
                                    <li><strong>Frequency:</strong> Real-time + Daily batch validation</li>
                                    <li><strong>Actions:</strong>
                                        <ul>
                                            <li>Query authentication logs every 5 minutes</li>
                                            <li>Validate OPA policy enforcement</li>
                                            <li>Generate compliance reports</li>
                                            <li>Alert on violations within 60 seconds</li>
                                        </ul>
                                    </li>
                                    <li><strong>Integration:</strong> Datadog, Splunk, AWS CloudWatch</li>
                                </ul>

                                <h3>2. User Onboarding Agent</h3>
                                <ul>
                                    <li><strong>Purpose:</strong> Automate MFA enrollment for new users</li>
                                    <li><strong>Trigger:</strong> New user account creation event</li>
                                    <li><strong>Workflow:</strong>
                                        <ol>
                                            <li>Send MFA setup email within 5 minutes of account creation</li>
                                            <li>Provide QR code for TOTP enrollment</li>
                                            <li>Track enrollment status</li>
                                            <li>Send reminder at 12h and 20h if incomplete</li>
                                            <li>Auto-disable account at 24h if MFA not configured</li>
                                        </ol>
                                    </li>
                                    <li><strong>Exception Handling:</strong> Service accounts flagged for manual review</li>
                                </ul>

                                <h3>3. Security Remediation Agent</h3>
                                <ul>
                                    <li><strong>Purpose:</strong> Automatically remediate MFA bypass attempts</li>
                                    <li><strong>Detection:</strong> Multiple failed MFA attempts, policy violations</li>
                                    <li><strong>Response Actions:</strong>
                                        <ul>
                                            <li>Lock account after 3 failed MFA attempts in 15 minutes</li>
                                            <li>Trigger security incident workflow</li>
                                            <li>Notify security team via PagerDuty</li>
                                            <li>Require password reset + MFA re-enrollment</li>
                                        </ul>
                                    </li>
                                </ul>

                                <h2>Guardrails</h2>

                                <h3>Hard Guardrails (Cannot be overridden)</h3>
                                <blockquote>
                                    <strong>MUST</strong> enforce MFA for all production access
                                </blockquote>
                                <blockquote>
                                    <strong>MUST NOT</strong> allow authentication with single factor after grace period
                                </blockquote>
                                <blockquote>
                                    <strong>MUST</strong> log all authentication events for audit
                                </blockquote>

                                <h3>Soft Guardrails (Can be overridden with approval)</h3>
                                <ul>
                                    <li><strong>SHOULD</strong> use hardware security keys (FIDO2) for privileged accounts</li>
                                    <li><strong>SHOULD</strong> enforce MFA re-verification every 8 hours</li>
                                    <li><strong>MAY</strong> allow SMS as backup factor (not primary)</li>
                                </ul>

                                <h2>Automation Workflows</h2>

                                <h3>Workflow 1: MFA Enforcement Deployment</h3>
                                <pre><code>Trigger: New service deployment
1. Pre-deployment scan for MFA integration
2. Run OPA policy validation in staging
3. Execute integration tests
4. Deploy with canary rollout (5% ‚Üí 25% ‚Üí 100%)
5. Monitor error rates and rollback if > 0.1%
6. Post-deployment compliance validation</code></pre>

                                <h3>Workflow 2: Incident Response</h3>
                                <pre><code>Trigger: MFA bypass detected
1. Immediately block suspicious authentication
2. Create SIEM alert
3. Notify SecOps team (PagerDuty P1)
4. Initiate forensic log collection
5. Trigger account lockdown procedure
6. Generate incident report within 4 hours</code></pre>

                                <h3>Workflow 3: Compliance Reporting</h3>
                                <pre><code>Schedule: Daily at 02:00 UTC
1. Query all authentication events (last 24h)
2. Calculate MFA coverage percentage
3. Identify non-compliant accounts
4. Generate executive dashboard
5. File compliance artifacts in audit system
6. Send summary to security@company.com</code></pre>

                                <h2>Integration Points</h2>
                                <ul>
                                    <li><strong>Identity Provider:</strong> Okta, Azure AD, Auth0</li>
                                    <li><strong>Policy Engine:</strong> Open Policy Agent (OPA)</li>
                                    <li><strong>SIEM:</strong> Splunk, Datadog, Elastic Security</li>
                                    <li><strong>Notification:</strong> PagerDuty, Slack, Email</li>
                                    <li><strong>CI/CD:</strong> GitHub Actions, Jenkins, GitLab CI</li>
                                </ul>

                                <h2>Success Metrics</h2>
                                <ul>
                                    <li>MFA Adoption Rate: 100% of active users</li>
                                    <li>Time to Enrollment: < 30 minutes (avg)</li>
                                    <li>Policy Violation Rate: < 0.01%</li>
                                    <li>Incident Response Time: < 5 minutes (P0)</li>
                                    <li>False Positive Rate: < 0.1%</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Validation Tab -->
                    <div class="tab-panel" id="validation">
                        <h2 style="margin-bottom: 1.5rem; font-size: 1.25rem; font-weight: 700;">Validation & Testing</h2>
                        
                        <h3 style="margin-bottom: 1rem; font-size: 1.125rem; font-weight: 700;">Validation Rules</h3>
                        <div class="validation-rules">
                            <div class="validation-rule">
                                ‚úì All authentication endpoints implement MFA verification
                            </div>
                            <div class="validation-rule">
                                ‚úì OPA policy deployed to production runtime
                            </div>
                            <div class="validation-rule">
                                ‚úì Minimum 2 authentication factors enforced
                            </div>
                            <div class="validation-rule">
                                ‚úì Grace period mechanism implemented for new users
                            </div>
                            <div class="validation-rule warning">
                                ‚ö† 12 accounts pending MFA enrollment (within grace period)
                            </div>
                            <div class="validation-rule">
                                ‚úì Audit logging capturing all MFA events
                            </div>
                        </div>

                        <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-size: 1.125rem; font-weight: 700;">Test Coverage</h3>
                        <div class="metamodel-grid">
                            <div class="field-group">
                                <label class="field-label">Unit Tests</label>
                                <div class="field-value">47 tests (100% passing)</div>
                            </div>
                            <div class="field-group">
                                <label class="field-label">Integration Tests</label>
                                <div class="field-value">23 tests (100% passing)</div>
                            </div>
                            <div class="field-group">
                                <label class="field-label">OPA Policy Tests</label>
                                <div class="field-value">15 tests (100% passing)</div>
                            </div>
                            <div class="field-group">
                                <label class="field-label">End-to-End Tests</label>
                                <div class="field-value">8 tests (100% passing)</div>
                            </div>
                        </div>

                        <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-size: 1.125rem; font-weight: 700;">Compliance Status</h3>
                        <div class="validation-rules">
                            <div class="validation-rule">
                                <strong>SOC 2 Type II:</strong> Compliant - Control CC6.1 satisfied
                            </div>
                            <div class="validation-rule">
                                <strong>ISO 27001:</strong> Compliant - Controls A.9.4.2, A.9.4.3 satisfied
                            </div>
                            <div class="validation-rule">
                                <strong>PCI DSS 3.2.1:</strong> Compliant - Requirement 8.3 satisfied
                            </div>
                            <div class="validation-rule">
                                <strong>NIST 800-53:</strong> Compliant - Controls IA-2(1), IA-2(2) satisfied
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-card">
                <h3 class="sidebar-title">Requirement Info</h3>
                <div class="info-list">
                    <div class="info-item">
                        <div class="info-label">Implementation Status</div>
                        <div class="info-value">‚úì Deployed to Production</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Target Release</div>
                        <div class="info-value">v2.1.0 (Released)</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Effort Estimate</div>
                        <div class="info-value">High (6-8 weeks)</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Risk Level</div>
                        <div class="info-value">Critical</div>
                    </div>
                </div>
            </div>

            <div class="sidebar-card">
                <h3 class="sidebar-title">Related Requirements</h3>
                <div class="link-list">
                    <a href="#" class="link-item">
                        <span>‚Üí</span>
                        REQ-SEC-002: Password Policy
                    </a>
                    <a href="#" class="link-item">
                        <span>‚Üí</span>
                        REQ-SEC-005: Session Management
                    </a>
                    <a href="#" class="link-item">
                        <span>‚Üí</span>
                        REQ-OPS-012: Audit Logging
                    </a>
                </div>
            </div>

            <div class="sidebar-card">
                <h3 class="sidebar-title">Traceability</h3>
                <div class="link-list">
                    <a href="#" class="link-item">
                        <span>üìã</span>
                        TEST-SEC-045
                    </a>
                    <a href="#" class="link-item">
                        <span>üìã</span>
                        TEST-SEC-046
                    </a>
                    <a href="#" class="link-item">
                        <span>üèóÔ∏è</span>
                        ARCH-IAM-001
                    </a>
                    <a href="#" class="link-item">
                        <span>üìñ</span>
                        DOC-SEC-023
                    </a>
                </div>
            </div>

            <div class="sidebar-card">
                <h3 class="sidebar-title">Tags</h3>
                <div class="tag-list">
                    <span class="tag">authentication</span>
                    <span class="tag">mfa</span>
                    <span class="tag">security</span>
                    <span class="tag">identity</span>
                    <span class="tag">compliance</span>
                    <span class="tag">critical</span>
                </div>
            </div>

            <div class="sidebar-card">
                <h3 class="sidebar-title">Resources</h3>
                <div class="link-list">
                    <a href="#" class="link-item">
                        <span>üìÑ</span>
                        NIST 800-63B Guidelines
                    </a>
                    <a href="#" class="link-item">
                        <span>üìÑ</span>
                        RFC 6238 (TOTP)
                    </a>
                    <a href="#" class="link-item">
                        <span>üìÑ</span>
                        WebAuthn Specification
                    </a>
                </div>
            </div>
        </aside>
    </div>

    <script>
        // Tab switching functionality
        const tabs = document.querySelectorAll('.tab');
        const tabPanels = document.querySelectorAll('.tab-panel');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.dataset.tab;
                
                // Remove active class from all tabs and panels
                tabs.forEach(t => t.classList.remove('active'));
                tabPanels.forEach(p => p.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding panel
                tab.classList.add('active');
                document.getElementById(targetTab).classList.add('active');
            });
        });

        // Copy button functionality
        document.querySelectorAll('.code-copy').forEach(button => {
            button.addEventListener('click', function() {
                const codeBlock = this.closest('.code-block').querySelector('pre');
                const text = codeBlock.textContent;
                
                navigator.clipboard.writeText(text).then(() => {
                    this.textContent = 'Copied!';
                    setTimeout(() => {
                        this.textContent = 'Copy';
                    }, 2000);
                });
            });
        });
    </script>
</body>
</html>